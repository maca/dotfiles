#!/usr/bin/ruby

all = %x[xrandr | /usr/bin/grep "connected" | awk '{ print $1 }' | awk -vORS=" " 1].split(" ")
conn = %x[xrandr | /usr/bin/grep " connected" | awk '{ print $1 }' | awk -vORS=" " 1].split(" ")
other = all - conn

def off(array)
  s = ""
  array.each{|m| s << "--output #{m} --off "}
  return s
end

# I assume that the displays get registered in this order LVDS VGA HDMI/DP
case conn.size
when 1
  system "xrandr --output #{conn[0]} --auto #{off(other)}"
when 2
  # Laptop left of the external monitor
  system "xrandr --output #{conn[1]} --auto --output #{conn[0]} --auto --left-of #{conn[1]} #{off(other)}"
when 3
  # Customise this at will (normally laptop graphics cards don't output to more than 2 displays)
  system "xrandr --output #{conn[1]} --auto --output #{conn[2]} --auto --right-of #{conn[1]} #{off([conn[0]])}"
else
  puts "no, no, no: #{conn}"
end
